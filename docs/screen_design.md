# グループTODO - 画面設計仕様書

## ドキュメント概要

- **作成日**: 2025-10-01
- **対象**: グループTODOアプリの全画面設計
- **目的**: UI/UX設計・画面遷移・機能仕様の明確化

---

## 画面構成概要

### アプリ起動フロー
1. **スプラッシュ画面** - 初回起動時の認証処理
2. **データ引き継ぎ確認画面** - 初回起動時のみ表示（引き継ぎ選択）
3. **メイン画面** - Bottom Navigation（3タブ構成）

### メイン画面（Bottom Navigation）
- 🏠 **ホーム画面（My TODO）** - 自分の担当TODO（当日〜1週間以内）
- 👥 **グループ画面（全TODO）** - 全グループのTODO管理
- ⚙️ **設定画面** - ユーザー設定・通知設定

### サブ画面
- **TODO詳細画面** - TODO情報・コメント表示
- **TODO作成/編集画面** - TODO入力フォーム
- **グループ詳細画面** - グループ情報・メンバー・TODO
- **グループ作成画面** - グループ作成フォーム
- **メンバー招待画面** - ユーザーID追加方式
- **グループ設定画面** - グループ編集・メンバー管理
- **定期TODO管理画面** - 定期TODO一覧・設定
- **定期TODO作成/編集画面** - 定期TODO設定フォーム

---

## 📱 アプリ起動フロー

### 1. スプラッシュ画面

#### 表示タイミング
- アプリ起動時（毎回表示）

#### 表示内容
- **アプリロゴ**: グループTODOのブランディング
- **ローディングインジケーター**: 処理中の視覚的フィードバック
- **バージョン情報**: 画面下部に小さく表示

#### 処理内容（バックグラウンド）
1. **デバイスID取得**: iOS（identifierForVendor）、Android（端末ID）、Web（ブラウザベース）
2. **ユーザー存在チェック**: デバイスIDでSupabaseユーザー検索
3. **未登録の場合**: 自動ユーザー作成
   - ユーザー名自動生成: `ユーザー` + `8桁数字`（例: ユーザー12345678）
   - 初期データ設定: アバター・作成日時
4. **データ読み込み**:
   - ユーザー情報取得
   - 所属グループ情報取得
   - キャッシュデータ確認

#### 遷移先
- **初回起動**: データ引き継ぎ確認画面へ
- **2回目以降**: ホーム画面へ

#### エラー処理
- **ネットワークエラー**: 再試行ボタン表示
- **システムエラー**: エラー画面とサポート連絡先表示
- **デバイスID取得失敗**: アプリ利用不可・エラー詳細表示

---

### 2. データ引き継ぎ確認画面

#### 表示タイミング
- 初回起動時のみ（スプラッシュ画面の後）

#### 表示内容
- **タイトル**: 「データ引き継ぎ」
- **説明文**:
  - 「以前使用していたデバイスからデータを引き継ぎますか？」
  - 「引き継がない場合は新規ユーザーとして開始します」
- **選択ボタン**:
  - 「引き継ぐ」ボタン
  - 「新規開始」ボタン

#### できること
- **「引き継ぐ」選択**: データ引き継ぎ入力画面へ遷移
- **「新規開始」選択**: そのままホーム画面へ遷移（新規ユーザーとして開始）

---

### 3. データ引き継ぎ入力画面

#### 表示内容
- **タイトル**: 「データ引き継ぎ」
- **入力フォーム**:
  - ユーザーID入力（必須）
  - 引き継ぎコード入力（必須・8桁英数字）
- **QRコード読み取りボタン**: カメラ起動で自動入力
- **アクションボタン**:
  - 「引き継ぐ」ボタン
  - 「キャンセル」ボタン

#### できること
- **ユーザーID・引き継ぎコード入力**: 手動入力
- **QRコード読み取り**: カメラ起動 → 自動入力
- **引き継ぐボタン**:
  - 入力値検証
  - Supabaseでユーザー認証
  - 成功: 現在のデバイスに紐付け → ホーム画面へ遷移
  - 失敗: エラーメッセージ表示
- **キャンセルボタン**: ホーム画面へ遷移（新規ユーザーとして開始）

#### エラーメッセージ
- 「ユーザーIDまたは引き継ぎコードが正しくありません」
- 「ネットワークエラーが発生しました」
- 「すでに引き継ぎ済みのデバイスです」

---

## 🏠 メイン画面（Bottom Navigation）

### Bottom Navigation 構成
```
[🏠 ホーム] [👥 グループ] [⚙️ 設定]
```

- **常時表示**: メイン3画面 + サブ画面でも表示継続
- **非表示**: モーダル表示中のみ

---

## 🏠 ホーム画面（My TODO）

### 画面コンセプト
- 自分が担当するTODOを期限順に表示
- 当日〜1週間以内の期限付きTODOに集中
- 個人のタスク管理に特化

### 表示内容

#### ヘッダー
- **画面タイトル**: 「My TODO」
- **期限フィルターボタン**:
  - 「当日」ボタン
  - 「3日以内」ボタン
  - 「1週間以内」ボタン
  - 選択中のフィルターは強調表示

#### TODO一覧エリア
- **表示対象**: 自分が担当のTODOのみ
- **フィルター適用**: 選択した期限内のTODO表示
- **セクション分け**:
  - 期限切れ（赤色警告）
  - 今日（強調表示）
  - 明日
  - 3日以内
  - 1週間以内

#### TODOカード表示項目
- **タイトル**: TODO名
- **期限**: 日時表示（色分け: 期限切れ=赤、当日=オレンジ、通常=グレー）
- **グループ名**: 所属グループ名
- **カテゴリタグ**: 買い物・家事・その他
- **完了チェックボックス**: タップで完了切り替え

#### スワイプジェスチャー
- **左スワイプ**: 完了マーク表示 → タップで完了
- **右スワイプ**: 削除ボタン表示 → タップで削除確認ダイアログ

#### FAB（Floating Action Button）
- **位置**: 画面右下
- **アイコン**: ＋マーク
- **機能**: TODO作成画面へ遷移

### できること

#### 期限フィルター切り替え
- 「当日」: 今日期限のTODOのみ表示
- 「3日以内」: 今日から3日以内期限のTODO表示
- 「1週間以内」: 今日から1週間以内期限のTODO表示
- フィルター選択でリアルタイム更新

#### TODO操作
- **TODOカードタップ**: TODO詳細画面へ遷移
- **完了チェックボックスタップ**: 完了/未完了切り替え
- **左スワイプ → 完了**: TODO完了
- **右スワイプ → 削除**: 削除確認ダイアログ表示

#### TODO作成
- **FABタップ**: TODO作成画面へ遷移

### 表示パターン

#### TODOが存在する場合
- セクション別に期限順表示
- 期限切れは最上部に警告表示

#### TODOが存在しない場合
- 「期限内のTODOはありません」メッセージ表示
- FABは常に表示

---

## 👥 グループ画面（全TODO）

### 画面コンセプト
- 全グループのTODOを一覧管理
- グループ単位でTODOを表示・管理
- グループ作成・参加の起点

### 表示内容

#### ヘッダー
- **画面タイトル**: 「グループ」
- **グループ追加ボタン**: 右上に「＋」アイコン

#### グループ一覧エリア
- **グループセクション**: グループごとにセクション表示
- **各グループセクション構成**:
  - グループアイコン（カラー）
  - グループ名
  - メンバー数表示
  - 未完了TODO件数表示
  - グループ詳細ボタン（右矢印）
  - 展開/折りたたみボタン

#### TODO一覧（各グループ内）
- **表示対象**: そのグループの全TODO（担当者問わず）
- **表示切り替えタブ**:
  - 「未完了」タブ（デフォルト）
  - 「完了済み」タブ

#### TODOカード表示項目
- **タイトル**: TODO名
- **期限**: 日時表示（色分け）
- **担当者アバター**: 複数担当者の場合は重ねて表示
- **カテゴリタグ**: 買い物・家事・その他
- **完了チェックボックス**: 担当者のみ操作可能

#### FAB（Floating Action Button）
- **位置**: 画面右下
- **アイコン**: ＋マーク
- **機能**: グループ作成画面へ遷移

### できること

#### グループ操作
- **グループセクションタップ**: 展開/折りたたみ
- **グループ詳細ボタンタップ**: グループ詳細画面へ遷移
- **グループ追加ボタン**: グループ作成画面 or 招待コード入力選択

#### TODO操作
- **TODOカードタップ**: TODO詳細画面へ遷移
- **完了チェックボックスタップ**: 完了/未完了切り替え（担当者のみ）
- **左スワイプ → 完了**: TODO完了（担当者のみ）
- **右スワイプ → 削除**: 削除確認ダイアログ表示（作成者・グループオーナーのみ）

#### 表示切り替え
- **未完了/完了済みタブ**: タブ切り替えでTODO表示変更

### 表示パターン

#### グループが存在する場合
- グループセクション別に表示
- 各グループのTODO一覧表示

#### グループが存在しない場合
- 「グループに参加していません」メッセージ表示
- 「グループを作成」ボタン
- 「グループに参加」ボタン

---

## ⚙️ 設定画面

### 画面コンセプト
- ユーザー情報管理
- アプリ設定・通知設定
- データ引き継ぎ機能

### 表示内容

#### ユーザー情報セクション
- **アバター表示**: 円形アバター
- **ユーザー名**: 表示名
- **ユーザーID**: 自動生成ID（コピーボタン付き）
- **編集ボタン**: ユーザー情報編集画面へ遷移

#### 通知設定セクション
- **期限通知**: ON/OFF トグル
  - 説明: 「期限が近いTODOを通知」
- **新規TODO通知**: ON/OFF トグル
  - 説明: 「新しいTODOが追加されたら通知」
- **担当TODO通知**: ON/OFF トグル
  - 説明: 「自分が担当に設定されたら通知」

#### データ管理セクション
- **データ引き継ぎコード生成**: ボタン
  - 説明: 「機種変更時にデータを引き継ぐためのコード」
- **データ引き継ぎ**: ボタン
  - 説明: 「他のデバイスからデータを引き継ぐ」
- **キャッシュクリア**: ボタン
  - 説明: 「ローカルキャッシュをクリア」

#### アプリ情報セクション
- **バージョン情報**: 現在のバージョン表示
- **利用規約**: リンク
- **プライバシーポリシー**: リンク
- **お問い合わせ**: リンク

### できること

#### ユーザー情報編集
- **編集ボタンタップ**: ユーザー情報編集画面へ遷移
- **ユーザーIDコピー**: クリップボードにコピー
- **アバター変更**: アバター選択画面へ遷移

#### 通知設定変更
- **各トグル切り替え**: 即座に設定保存

#### データ管理
- **データ引き継ぎコード生成**:
  - 8桁英数字コード生成
  - QRコード表示
  - コピーボタン
  - 有効期限表示（24時間）
- **データ引き継ぎ**: データ引き継ぎ入力画面へ遷移
- **キャッシュクリア**: 確認ダイアログ → 実行

---

## 📝 TODO関連画面

### 4. TODO詳細画面

#### 表示内容

##### TODO情報セクション
- **タイトル**: TODO名（大きく表示）
- **詳細説明**: テキストエリア表示
- **期限**: 日時表示（色分け）
- **担当者**: アバター＋名前のリスト表示
- **カテゴリ**: タグ表示（買い物・家事・その他）
- **作成者**: 作成者名
- **作成日時**: YYYY-MM-DD HH:MM形式
- **完了状態**: 完了/未完了バッジ

##### コメントセクション
- **コメント一覧**: 時系列順表示
  - コメント投稿者アバター・名前
  - コメント内容（URLリンク禁止）
  - 投稿日時
- **コメント入力フォーム**:
  - テキスト入力エリア
  - 送信ボタン
  - **セキュリティ**: URL・外部リンク入力禁止

##### アクションボタンエリア
- **完了/未完了切り替えボタン**: 大きなボタン
- **編集ボタン**: TODO編集画面へ遷移
- **削除ボタン**: 削除確認ダイアログ表示

#### できること

##### 情報閲覧
- TODO詳細情報の確認
- コメント履歴の確認

##### TODO操作
- **完了/未完了切り替え**: 担当者のみ操作可能
- **編集**: 作成者・グループオーナーのみ
- **削除**: 作成者・グループオーナーのみ

##### コメント操作
- **コメント投稿**: グループメンバー全員可能
- **URL入力制限**: システムで自動検知・エラー表示
- **不適切ワード検出**: フィルタリング・警告表示

#### セキュリティ対策
- **URL・リンク禁止**: `http://`, `https://`, `www.` など検出
- **不適切キーワードフィルタ**: 出会い系関連ワードの検出
- **違反時の処理**: 投稿エラー・警告メッセージ表示

---

### 5. TODO作成/編集画面

#### 表示内容

##### 入力フォーム
- **タイトル**: テキスト入力（必須）
  - プレースホルダー: 「TODOのタイトルを入力」
- **詳細説明**: テキストエリア（任意）
  - プレースホルダー: 「詳細を入力（任意）」
- **グループ選択**: ドロップダウン（必須）
  - 自分が所属するグループから選択
- **期限設定**: 日時ピッカー（任意）
  - 「期限なし」チェックボックス
- **担当者選択**: 複数選択可能（必須）
  - グループメンバーから選択
  - 自分をデフォルトで選択状態
- **カテゴリ選択**: ラジオボタン（必須）
  - 買い物
  - 家事
  - その他

##### アクションボタン
- **保存ボタン**: 画面上部右
- **キャンセルボタン**: 画面上部左

#### できること

##### 入力操作
- **各項目の入力・選択**: フォーム入力
- **期限設定**: 日付・時刻ピッカー表示
- **担当者複数選択**: チェックボックス方式

##### 保存・キャンセル
- **保存ボタン**:
  - 入力値バリデーション
  - 必須項目チェック
  - Supabaseに保存
  - 成功: 前の画面に戻る
  - 失敗: エラーメッセージ表示
- **キャンセルボタン**:
  - 入力内容破棄確認ダイアログ
  - 確認後: 前の画面に戻る

#### バリデーション
- **タイトル**: 空白不可、最大100文字
- **詳細説明**: 最大500文字
- **グループ**: 未選択不可
- **担当者**: 最低1名選択必須
- **カテゴリ**: 未選択不可

---

## 👥 グループ関連画面

### 6. グループ詳細画面

#### 表示内容

##### ヘッダー
- **グループアイコン**: カラーアイコン
- **グループ名**: 大きく表示
- **設定ボタン**: 右上（歯車アイコン）
- **招待ボタン**: 右上（人追加アイコン）

##### タブ切り替え
- **TODOタブ**: このグループのTODO一覧（デフォルト）
- **メンバータブ**: メンバー一覧
- **定期TODOタブ**: 定期TODO一覧

##### TODOタブ内容
- **表示切り替え**: 未完了/完了済み
- **TODO一覧**: グループ内の全TODO表示
- **TODOカード**: ホーム画面と同様の表示

##### メンバータブ内容
- **メンバーリスト**:
  - アバター
  - ユーザー名
  - ロール表示（オーナー・メンバー）
  - 参加日時

##### 定期TODOタブ内容
- **定期TODO一覧**:
  - タイトル
  - 繰り返し設定（毎週月曜、毎月1日など）
  - 次回生成日時
  - 有効/一時停止状態
- **FAB**: 定期TODO作成画面へ遷移

##### FAB（Floating Action Button）
- **TODOタブ**: TODO作成画面へ遷移（グループ事前選択済み）
- **定期TODOタブ**: 定期TODO作成画面へ遷移

#### できること

##### タブ切り替え
- **各タブタップ**: 表示内容切り替え

##### TODO操作（TODOタブ）
- **TODOカードタップ**: TODO詳細画面へ遷移
- **完了/未完了切り替え**: 担当者のみ
- **FAB**: TODO作成（グループ自動選択）

##### メンバー確認（メンバータブ）
- **メンバー情報閲覧**: ロール・参加日時確認

##### 定期TODO操作（定期TODOタブ）
- **定期TODOタップ**: 定期TODO編集画面へ遷移
- **一時停止/再開**: トグルスイッチで切り替え
- **FAB**: 定期TODO作成

##### グループ管理
- **招待ボタン**: メンバー招待画面へ遷移
- **設定ボタン**: グループ設定画面へ遷移

---

### 7. グループ作成画面

#### 表示内容

##### 入力フォーム
- **グループ名**: テキスト入力（必須）
  - プレースホルダー: 「グループ名を入力」
- **説明**: テキストエリア（任意）
  - プレースホルダー: 「グループの説明（任意）」
- **グループアイコン**: カラー選択
  - カラーパレット表示（10色程度）
  - 選択中の色を大きく表示

##### アクションボタン
- **作成ボタン**: 画面下部
- **キャンセルボタン**: 画面上部左

#### できること

##### 入力操作
- **グループ名入力**: テキスト入力
- **説明入力**: 複数行テキスト入力
- **アイコン色選択**: カラーパレットからタップ選択

##### 作成・キャンセル
- **作成ボタン**:
  - 入力値バリデーション
  - Supabaseにグループ作成
  - 自分をオーナーとして登録
  - 成功: グループ詳細画面へ遷移
  - 失敗: エラーメッセージ表示
- **キャンセルボタン**: 入力破棄確認 → 前の画面に戻る

#### バリデーション
- **グループ名**: 空白不可、最大50文字
- **説明**: 最大200文字
- **アイコン色**: 必須選択

---

### 8. メンバー招待画面

#### 表示内容

##### ユーザーID追加方式
- **タイトル**: 「メンバーを招待」
- **説明文**: 「招待したい相手のユーザーIDを入力してください」
- **入力フォーム**:
  - ユーザーID入力欄（必須）
  - プレースホルダー: 「ユーザーIDを入力」
- **アクションボタン**:
  - 「追加」ボタン
  - 「閉じる」ボタン

##### 現在のメンバー表示
- **メンバーリスト**:
  - アバター・ユーザー名・ロール
  - 削除ボタン（オーナーのみ表示）

#### できること

##### メンバー追加
- **ユーザーID入力**: テキスト入力
- **追加ボタン**:
  - ユーザーID検証
  - 存在チェック
  - グループメンバーに追加
  - 成功: メンバーリストに追加表示
  - 失敗: エラーメッセージ表示

##### エラーメッセージ
- 「ユーザーIDが見つかりません」
- 「すでにグループに参加しています」
- 「自分自身は追加できません」

##### メンバー削除（オーナーのみ）
- **削除ボタンタップ**: 削除確認ダイアログ → 削除実行

---

### 9. グループ設定画面

#### 表示内容

##### グループ情報セクション
- **グループ名**: 編集可能テキスト
- **説明**: 編集可能テキストエリア
- **アイコン色**: 変更可能（カラーパレット）

##### メンバー管理セクション（オーナーのみ表示）
- **メンバー一覧**:
  - アバター・ユーザー名・ロール
  - 削除ボタン（メンバーのみ・オーナーは削除不可）

##### 危険な操作セクション
- **グループから退出**: ボタン（メンバーのみ表示）
- **グループ削除**: ボタン（オーナーのみ表示・赤色強調）

##### アクションボタン
- **保存ボタン**: 画面上部右
- **キャンセルボタン**: 画面上部左

#### できること

##### グループ情報編集
- **グループ名変更**: テキスト編集
- **説明変更**: テキストエリア編集
- **アイコン色変更**: カラーパレット選択

##### メンバー管理（オーナーのみ）
- **メンバー削除**: 削除確認ダイアログ → 削除実行
- **注意**: オーナー自身は削除不可

##### グループ退出（メンバー）
- **退出ボタン**:
  - 確認ダイアログ表示
  - 「グループから退出しますか？退出後は再度招待が必要です」
  - 確認後: グループメンバーから削除 → グループ画面へ戻る

##### グループ削除（オーナー）
- **削除ボタン**:
  - 厳重な確認ダイアログ表示
  - 「グループを削除しますか？全てのTODO・データが削除されます。この操作は取り消せません。」
  - グループ名入力による最終確認
  - 確認後: グループ・関連TODO・メンバー情報すべて削除 → グループ画面へ戻る

---

## 🔄 定期TODO関連画面

### 10. 定期TODO管理画面

#### 表示内容

##### ヘッダー
- **画面タイトル**: 「定期TODO」
- **グループ選択**: ドロップダウン（グループ別表示切り替え）

##### 定期TODO一覧
- **定期TODOカード**:
  - タイトル
  - 繰り返し設定（例: 毎週月曜 9:00）
  - 次回生成日時
  - 担当者アバター
  - カテゴリタグ
  - 有効/一時停止トグルスイッチ

##### FAB（Floating Action Button）
- **位置**: 画面右下
- **アイコン**: ＋マーク
- **機能**: 定期TODO作成画面へ遷移

#### できること

##### 表示操作
- **グループ選択**: ドロップダウンで表示グループ切り替え
- **定期TODOカードタップ**: 定期TODO編集画面へ遷移

##### 定期TODO操作
- **一時停止/再開**: トグルスイッチで即座に切り替え
- **削除**: 長押し → 削除確認ダイアログ → 削除実行

##### 新規作成
- **FABタップ**: 定期TODO作成画面へ遷移

---

### 11. 定期TODO作成/編集画面

#### 表示内容

##### 入力フォーム
- **タイトル**: テキスト入力（必須）
  - プレースホルダー: 「定期TODOのタイトル」
- **詳細説明**: テキストエリア（任意）
- **グループ選択**: ドロップダウン（必須）
- **担当者選択**: 複数選択可能（必須）
- **カテゴリ選択**: ラジオボタン（必須）

##### 繰り返し設定セクション
- **繰り返しパターン**: ラジオボタン
  - 毎日
  - 毎週（曜日選択）
  - 毎月（日付選択）
- **曜日選択**: 複数選択チェックボックス
  - 月・火・水・木・金・土・日
- **日付選択**: 数値入力
  - 1〜31日
  - 「月末」オプション
- **生成時刻**: 時刻ピッカー
  - デフォルト: 09:00

##### プレビュー表示
- **次回生成日時**: リアルタイム表示
- **今後の生成予定**: 今後5回分の日時表示

##### アクションボタン
- **保存ボタン**: 画面上部右
- **キャンセルボタン**: 画面上部左

#### できること

##### 入力操作
- **各項目の入力・選択**: フォーム入力
- **繰り返しパターン選択**: ラジオボタン選択
- **曜日選択**: 複数選択可能（毎週の場合）
- **日付選択**: 数値入力（毎月の場合）
- **生成時刻選択**: 時刻ピッカー

##### プレビュー確認
- **リアルタイム更新**: 設定変更で次回生成日時自動更新

##### 保存・キャンセル
- **保存ボタン**:
  - 入力値バリデーション
  - 定期TODO設定保存
  - 成功: 定期TODO管理画面へ戻る
  - 失敗: エラーメッセージ表示
- **キャンセルボタン**: 入力破棄確認 → 前の画面に戻る

#### バリデーション
- **タイトル**: 空白不可、最大100文字
- **グループ**: 未選択不可
- **担当者**: 最低1名選択必須
- **繰り返しパターン**: 未選択不可
- **曜日/日付**: 繰り返しパターンに応じて必須

#### 定期TODO自動生成ロジック
- **生成タイミング**: 設定した日時に自動実行
- **生成内容**: 定期TODO設定を元にTODO作成
- **一時停止時**: 自動生成停止
- **再開時**: 次回生成日時から再開

---

## 画面遷移図

```
[スプラッシュ画面]
    ↓
[データ引き継ぎ確認画面]（初回のみ）
    ↓ 「新規開始」 or 「引き継ぎ完了」
    ↓
[ホーム画面（My TODO）] ←→ [グループ画面] ←→ [設定画面]
    ↓                       ↓                  ↓
[TODO詳細]              [グループ詳細]      [ユーザー情報編集]
    ↓                       ↓                  ↓
[TODO編集]              [メンバー招待]      [データ引き継ぎ]
                            ↓
                        [グループ設定]
                            ↓
                        [定期TODO管理]
                            ↓
                        [定期TODO編集]
```

---

## UI/UXデザイン方針

### デザインシステム

#### カラーパレット
- **プライマリー**: 緑系（#4CAF50）- タスク完了の達成感
- **セカンダリー**: オレンジ系（#FF9800）- アクション強調
- **背景**: 白・グレー系（#FAFAFA）- シンプル・見やすさ重視
- **期限切れ**: 赤系（#F44336）- 警告
- **期限近い**: オレンジ系（#FF9800）- 注意

#### タイポグラフィ
- **見出し**: 20-24pt、太字
- **本文**: 16pt、通常
- **キャプション**: 12-14pt、薄字

#### レイアウト
- **カードベースUI**: 影付きカード表示
- **スペーシング**: 8pxグリッドシステム
- **角丸**: 12px（統一）

### インタラクション

#### スワイプジェスチャー
- **左スワイプ**: 完了アクション（緑背景）
- **右スワイプ**: 削除アクション（赤背景）
- **スワイプ距離**: 画面幅の30%以上で確定

#### タップ領域
- **最小タップサイズ**: 44x44pt（iOS HIG準拠）
- **カードタップ**: カード全体がタップ可能

#### アニメーション
- **画面遷移**: 0.3秒スライドアニメーション
- **ボタンタップ**: スケールアニメーション（0.95倍）
- **完了切り替え**: フェードイン/アウト

### アクセシビリティ
- **コントラスト比**: WCAG AA準拠（4.5:1以上）
- **フォントサイズ**: Dynamic Type対応
- **VoiceOver**: 全要素にラベル設定

---

## セキュリティ・プライバシー設計

### コメント機能のセキュリティ

#### URL・リンク検出
- **検出パターン**:
  - `http://`, `https://`
  - `www.`
  - `://`
  - `.com`, `.net`, `.jp` などのドメイン
- **処理**: 投稿エラー・警告メッセージ表示

#### 不適切ワードフィルタリング
- **検出対象**: 出会い系・個人情報要求関連キーワード
- **処理**: 投稿エラー・警告メッセージ表示

#### 実装方法
- **クライアント側チェック**: 入力時リアルタイム検証
- **サーバー側チェック**: API送信時再検証
- **二重チェック**: セキュリティ強化

### データ保護
- **Row Level Security (RLS)**: Supabaseで適切なアクセス制御
- **グループデータ**: 所属メンバーのみアクセス可能
- **ユーザーデータ**: 本人のみアクセス可能

### プライバシー
- **匿名性**: メールアドレス・電話番号不要
- **個人情報**: 個人を特定できる情報は保存しない
- **グループ内表示**: ユーザー名・アバターはグループ内のみ

---

## エラー処理・フォールバック

### エラーパターン

#### ネットワークエラー
- **表示**: 「ネットワークに接続できません」
- **アクション**: 再試行ボタン

#### データ取得失敗
- **表示**: 「データの読み込みに失敗しました」
- **アクション**: 再試行ボタン

#### 権限エラー
- **表示**: 「この操作を行う権限がありません」
- **アクション**: 閉じるボタン

#### バリデーションエラー
- **表示**: 各入力フォーム下に赤文字で表示
- **例**: 「タイトルを入力してください」

### フォールバック禁止
- **DB接続前提**: Supabase接続必須
- **ローカルデータフォールバック**: 実装しない
- **オフライン動作**: サポートしない

---

## 技術実装ガイドライン

### 状態管理
- **StatefulWidget**: 画面ごとの状態管理
- **Service Layer Pattern**: ビジネスロジック分離

### データ取得
- **Supabase Realtime**: リアルタイム同期
- **キャッシュ**: SharedPreferencesでローカルキャッシュ

### 画面遷移
- **Navigator 2.0**: 宣言的ルーティング
- **Deep Link**: 将来的な対応準備

### パフォーマンス
- **Lazy Loading**: 長いリストのページネーション
- **画像最適化**: アバター画像のキャッシュ
- **メモリ管理**: 適切なリソース解放

---

**最終更新日**: 2025-10-01
**実装状況**: 画面設計完了、実装前
